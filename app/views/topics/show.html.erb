<p id="notice"><%= notice %></p>

<h1><%= @topic.name %></h1>
<h2><%= "Requested by #{@topic.requester.name} on #{@topic.created_at.to_date.strftime('%B %d, %Y')}" %></h2>
<p><%= @topic.notes %></p>

<h3>Status</h3>
  <% if @topic.status == "requested" %>
    <p>No one is writing about this yet.</p>

    <%= form_tag(posts_path(@topic.post)) do %>
      <%= hidden_field_tag :topic_id, params[:id] %>
      <%= hidden_field_tag :writer_id, current_user.id %>
      <%= submit_tag "Sign up to write a post on this topic!" %><br><br>
    <% end %>

  <% elsif @topic.status == "pending" %>
    <% if logged_in? && @topic.writer.id == current_user.id %>
      <p><%= "You are working on this post!" %></p>
      <%= link_to 'Finished this post? Submit the link!', edit_post_path(@topic.post) %><br>
      <%= link_to 'Changed your mind? Remove this from your list.', post_path(@topic.post), method: :delete, data: {confirm: 'Are you sure you want to stop working on this post?'}%><br>
    <% else %>
    <p><%= "#{@topic.writer.name} started working on this post on #{@topic.claimed_at.to_date.strftime('%B %d, %Y')}." %></p>
    <% end %>

  <% elsif @topic.status == "completed" %>
    <% if logged_in? && @topic.writer.id == current_user.id %>
      <p><%= "You wrote this post!" %></p>
    <% else %>
      <p><%= "#{@topic.writer.name} wrote this post on #{@topic.completed_at.to_date.strftime('%B %d, %Y')}!" %></p>
    <% end %>
    <p><%= link_to "Read it here.", @topic.link %></p>
  <% end %>

<% if logged_in? && @topic.requester.id == current_user.id %>
<%= link_to 'Edit', edit_topic_path(@topic) %> |
<%= link_to 'Delete', @topic, method: :delete, data: { confirm: 'Are you sure you want to delete this topic?'}%> |
<% end %>
<%= link_to 'Back to all topics!', topics_path %>